@model ToDoList.Models.HomePageModel

@{
    ViewData["Title"] = "Список задач";
}

<h2>@ViewData["Title"]</h2>

<p>
    <form asp-action="Create" method="post">
        <div class="form-group">
            <label asp-for="ToDoInput.Title"></label>
            <input asp-for="ToDoInput.Title" class="form-control" />
            <span asp-validation-for="ToDoInput.Title" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="ToDoInput.Deadline"></label>
            <input asp-for="ToDoInput.Deadline" type="datetime-local" class="form-control"
                   value="@Model.ToDoInput?.Deadline.ToString("yyyy-MM-ddTHH:mm")" />
            <span asp-validation-for="ToDoInput.Deadline" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="ToDoInput.CategoryId">Категорія</label>
            <select asp-for="ToDoInput.CategoryId" class="form-control">
                @foreach (var category in Model.Categories)
                {
                    <option value="@category.Id">@category.Name</option>
                }
            </select>
            <span asp-validation-for="ToDoInput.CategoryId" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-primary">Додати</button>
    </form>
</p>

<div>
    @if (Model.UnComplitedToDoItems.Count != 0)
    {
        <h3>Поточні задачі</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>Назва</th>
                    <th>Дедлайн</th>
                    <th>Категорія</th>
                    <th>Статус</th>
                    <th>Дії</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.UnComplitedToDoItems)
                {
                    <tr>
                        <td>@item.Title</td>
                        <td>@item.Deadline.ToString("dd.MM.yyyy HH:mm")</td>
                        <td>@item.Category.Name</td>
                        <td>
                            @(item.CompleteDate.HasValue ? "✅ Завершено" : "⏳ В процесі")
                        </td>
                        <td>
                            <a asp-action="Complete" asp-route-id="@item.Id"
                               onclick="return confirm('Ви точно хочете завершити задачу?')">
                                Завершити
                            </a> |
                            <a asp-action="GetToDoById" asp-route-id="@item.Id">Редагувати</a> |
                            <a asp-action="Delete" asp-route-id="@item.Id"
                               onclick="return confirm('Ви точно хочете видалити задачу?')">
                                Видалити
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
</div>

<div>
    @if (Model.CompletedToDoItems.Count != 0)
    {
        <h3>Завершенні задачі</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>Назва</th>
                    <th>Дата виконання</th>
                    <th>Категорія</th>
                    <th>Статус</th>
                    <th>Дії</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.CompletedToDoItems)
                {
                    <tr>
                        <td>@item.Title</td>
                        <td>
                            @(item.CompleteDate.HasValue
                                ? item.CompleteDate.Value.ToString("dd.MM.yyyy HH:mm")
                                : "—")
                        </td>
                        <td>@item.Category.Name</td>
                        <td>
                            @(item.CompleteDate.HasValue ? "✅ Завершено" : "⏳ В процесі")
                        </td>
                        <td>
                            <a asp-action="Complete" asp-route-id="@item.Id"
                               onclick="return confirm('Ви точно хочете завершити задачу?')">
                                Завершити
                            </a> |
                            <a asp-action="GetToDoById" asp-route-id="@item.Id">Редагувати</a> |
                            <a asp-action="Delete" asp-route-id="@item.Id"
                               onclick="return confirm('Ви точно хочете видалити задачу?')">
                                Видалити
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
</div>


